// Generated by `wit-bindgen` 0.6.0. DO NOT EDIT!
#include "bindings.h"

__attribute__((__import_module__("http"), __import_name__("send-http-request"))) void __wasm_import_http_send_http_request(int32_t, int32_t, int32_t, int32_t, int32_t, int32_t, int32_t, int32_t, int32_t, int32_t, int32_t);

__attribute__((__weak__, __export_name__("canonical_abi_realloc"))) void *cabi_realloc(void *ptr, size_t old_size, size_t align, size_t new_size)
{
  if (new_size == 0)
    return (void *)align;
  void *ret = realloc(ptr, new_size);
  if (!ret)
    abort();
  return ret;
}

__attribute__((weak, export_name("canonical_abi_free"))) void canonical_abi_free(
    void *ptr,
    size_t size,
    size_t align)
{
  free(ptr);
}

// Helper Functions

void http_types_uri_free(http_types_uri_t *ptr)
{
  bindings_string_free(ptr);
}

void http_types_http_param_free(http_types_http_param_t *ptr)
{
  bindings_string_free(&ptr->f0);
  bindings_string_free(&ptr->f1);
}

void http_types_http_params_free(http_types_http_params_t *ptr)
{
  for (size_t i = 0; i < ptr->len; i++)
  {
    http_types_http_param_free(&ptr->ptr[i]);
  }
  if (ptr->len > 0)
  {
    free(ptr->ptr);
  }
}

void http_types_http_header_free(http_types_http_header_t *ptr)
{
  bindings_string_free(&ptr->f0);
  bindings_string_free(&ptr->f1);
}

void http_types_http_headers_free(http_types_http_headers_t *ptr)
{
  for (size_t i = 0; i < ptr->len; i++)
  {
    http_types_http_header_free(&ptr->ptr[i]);
  }
  if (ptr->len > 0)
  {
    free(ptr->ptr);
  }
}

void http_types_http_request_error_free(http_types_http_request_error_t *ptr)
{
  bindings_string_free(&ptr->message);
}

void http_types_http_body_free(http_types_http_body_t *ptr)
{
  if (ptr->len > 0)
  {
    free(ptr->ptr);
  }
}

void bindings_option_http_body_free(bindings_option_http_body_t *ptr)
{
  if (ptr->is_some)
  {
    http_types_http_body_free(&ptr->val);
  }
}

void http_types_http_response_free(http_types_http_response_t *ptr)
{
  bindings_option_http_body_free(&ptr->body);
  http_types_http_headers_free(&ptr->headers);
}

void http_types_http_request_free(http_types_http_request_t *ptr)
{
  bindings_option_http_body_free(&ptr->body);
  http_types_http_headers_free(&ptr->headers);
  http_types_http_params_free(&ptr->params);
  http_types_uri_free(&ptr->uri);
}

void http_interface_http_request_free(http_interface_http_request_t *ptr)
{
  http_types_http_request_free(ptr);
}

void http_interface_http_response_free(http_interface_http_response_t *ptr)
{
  http_types_http_response_free(ptr);
}

void http_interface_http_request_error_free(http_interface_http_request_error_t *ptr)
{
  http_types_http_request_error_free(ptr);
}

void bindings_result_http_response_http_request_error_free(bindings_result_http_response_http_request_error_t *ptr)
{
  if (!ptr->is_err)
  {
    http_interface_http_response_free(&ptr->val.ok);
  }
  else
  {
    http_interface_http_request_error_free(&ptr->val.err);
  }
}

void bindings_string_set(bindings_string_t *ret, const char *s)
{
  ret->ptr = (char *)s;
  ret->len = strlen(s);
}

void bindings_string_dup(bindings_string_t *ret, const char *s)
{
  ret->len = strlen(s);
  ret->ptr = cabi_realloc(NULL, 0, 1, ret->len * 1);
  memcpy(ret->ptr, s, ret->len * 1);
}

void bindings_string_free(bindings_string_t *ret)
{
  if (ret->len > 0)
  {
    free(ret->ptr);
  }
  ret->ptr = NULL;
  ret->len = 0;
}

// Component Adapters

void http_send_http_request(http_interface_http_request_t *request, bindings_result_http_response_http_request_error_t *ret)
{
  __attribute__((__aligned__(4)))
  uint8_t ret_area[28];
  int32_t option;
  int32_t option1;
  int32_t option2;
  if (((*request).body).is_some)
  {
    const http_types_http_body_t *payload0 = &((*request).body).val;
    option = 1;
    option1 = (int32_t)(*payload0).ptr;
    option2 = (int32_t)(*payload0).len;
  }
  else
  {
    option = 0;
    option1 = 0;
    option2 = 0;
  }

  int32_t ptr = (int32_t)&ret_area;
  __wasm_import_http_send_http_request(option, option1, option2, (int32_t)((*request).headers).ptr, (int32_t)((*request).headers).len, (int32_t)(*request).method, (int32_t)((*request).params).ptr, (int32_t)((*request).params).len, (int32_t)((*request).uri).ptr, (int32_t)((*request).uri).len, ptr);
  bindings_result_http_response_http_request_error_t result;
  switch ((int32_t)(*((uint8_t *)(ptr + 0))))
  {
  case 0:
  {
    result.is_err = false;
    bindings_option_http_body_t option3;
    switch ((int32_t)(*((uint8_t *)(ptr + 4))))
    {
    case 0:
    {
      option3.is_some = false;
      break;
    }
    case 1:
    {
      option3.is_some = true;
      option3.val = (http_types_http_body_t){(uint8_t *)(*((int32_t *)(ptr + 8))), (size_t)(*((int32_t *)(ptr + 12)))};
      break;
    }
    }

    result.val.ok = (http_types_http_response_t){
        option3,
        (http_types_http_headers_t){(http_types_http_header_t *)(*((int32_t *)(ptr + 16))), (size_t)(*((int32_t *)(ptr + 20)))},
        (uint16_t)((int32_t)(*((uint16_t *)(ptr + 24)))),
    };
    break;
  }
  case 1:
  {
    result.is_err = true;
    result.val.err = (http_types_http_request_error_t){
        (int32_t)(*((uint8_t *)(ptr + 4))),
        (bindings_string_t){(char *)(*((int32_t *)(ptr + 8))), (size_t)(*((int32_t *)(ptr + 12)))},
    };
    break;
  }
  }
  *ret = result;
}

extern void __component_type_object_force_link_bindings(void);
void __component_type_object_force_link_bindings_public_use_in_this_compilation_unit(void)
{
  __component_type_object_force_link_bindings();
}
